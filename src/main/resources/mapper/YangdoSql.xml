<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.mapper.YangdoMapper">

    <insert id="insertYList" parameterType="YangdoDto">
        insert into yangdo values (null,#{unum},#{ycontent},now(),#{yprice},#{yplace},#{yday},#{ysubject})
    </insert>

    <select id="getAllDatas" resultType="YangdoDto">
        select * from yangdo order by ynum desc
    </select>

    <select id="getData" parameterType="int" resultType="YangdoDto">
        select * ,(select unickname from user where unum=yangdo.unum) as unickname,
               (select uhp from user where unum=yangdo.unum) as uhp
        from yangdo where ynum=#{ynum}
    </select>

    <delete id="deleteYangdo" parameterType="int">
        delete from yangdo where ynum=#{ynum}
    </delete>

    <select id="getTotalCount" resultType="int">
        select count(*) from yangdo
    </select>

    <select id="getPagingList" parameterType="Map" resultType="YangdoDto">
        select * ,(select unickname from user where unum=yangdo.unum) as unickname,
               (select uhp from user where unum=yangdo.unum) as uhp
        from yangdo order by yday asc, ysubject asc limit #{start},#{perpage}
    </select>

    <update id="updateYangdo" parameterType="YangdoDto">
        update yangdo set ycontent=#{ycontent}, yprice=#{yprice}, yplace=#{yplace},
                          yday=#{yday}, ysubject=#{ysubject} where ynum=#{ynum}
    </update>

    <select id="MyYangdoList" parameterType="Map" resultType="YangdoDto">
        select * ,(select unickname from user where unum=yangdo.unum) as unickname,
               (select uhp from user where unum=yangdo.unum) as uhp
        from yangdo where unum=#{unum} order by ynum desc limit #{start},#{perpage}
    </select>

    <select id="getMyCount" parameterType="int" resultType="int">
        select count(*) from yangdo where unum=#{unum}
    </select>
</mapper>